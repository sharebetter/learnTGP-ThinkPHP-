<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZHM博客</title>
<link href="https://cdn.bootcss.com/cropper/3.1.3/cropper.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="__STATIC__/public/bs/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="__STATIC__/public/bs/css/nprogress.css">
<link rel="stylesheet" type="text/css" href="__STATIC__/public/bs/css/style.css">
<link rel="stylesheet" type="text/css" href="__STATIC__/public/bs/css/font-awesome.min.css">
<link rel="apple-touch-icon-precomposed" href="__STATIC__/public/bs/images/icon/icon.png">
<link rel="shortcut icon" href="__STATIC__/public/bs/images/icon/favicon.ico">
<script src="__STATIC__/public/bs/js/jquery-2.1.4.min.js"></script>
<script src="__STATIC__/public/bs/js/nprogress.js"></script>
<script src="__STATIC__/public/bs/js/jquery.lazyload.min.js"></script>
<!--[if gte IE 9]>
  <script src="js/jquery-1.11.1.min.js" type="text/javascript"></script>
  <script src="js/html5shiv.min.js" type="text/javascript"></script>
  <script src="js/respond.min.js" type="text/javascript"></script>
  <script src="js/selectivizr-min.js" type="text/javascript"></script>
<![endif]-->
<!--[if lt IE 9]>
  <script>window.location.href='upgrade-browser.html';</script>
<![endif]-->
<style>
.title{
  text-align: center;
  color: #999;
}
.headimg{
  margin:0 auto;
}
.head{
  width: 50px;
  height:50px;
  border-radius: 50%
}
*{
  cursor: pointer;
}


#photo {
        max-width:100%;
        max-height:350px;
    }
    .img-preview-box {
        text-align: center;
    }
    .img-preview-box > div {
        display: inline-block;;
        margin-right: 10px;
    }
    .img-preview {
        overflow: hidden;
    }
    .img-preview-box .img-preview-lg {
        width: 150px;
        height: 150px;
    }
    .img-preview-box .img-preview-md {
        width: 100px;
        height: 100px;
    }
    .img-preview-box .img-preview-sm {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }



#mo{
  display: none;/*隐藏*/
  width: 100%;
  height: 100%;
  position: fixed;
  overflow: auto;
  background-color: rgba(0,0,0,0.7);
  top: 0px;
  left: 0px;
  z-index: 7;
 }
 #moimg{
  display: block;
  width: 50%;
  margin:5% auto;
  max-width: 750px;
  /*height: 70%;*/
 }
 #caption{
  text-align: center;
  margin: 15px auto;
  width: 60%;
  max-height: 750px;
  font-size: 20px;
  color:#ccc;
 }
 #moimg,#caption{
  -webkit-animation: first 1s;
  -o-animation: first 1s;
  animation: first 1s;
 }
 @keyframes first{
  from{transform: scale(0.1);}
  to{transform: scale(1);}
 }
 .close{
  font-size: 40px;
  font-weight: bold;
  position: absolute;
  top: 20px;
  right: 14%;
  color:#f1f1f1;
 }
 .close:hover,
 .close:focus{
  color:#bbb;
  cursor:pointer;
 }
 @media only screen and(min-width:750px ) {
  #moimg{
   width: 100%;
   height: 70%;
  }
 }
 @media only screen and(max-width:750px ) {
  #moimg{
   width: 100%;
   height: 30%;
  }
 }
 .intro{
  width: 100%;
  text-align: center;
  display: flex;
  justify-content:space-around;
 }
 .intro li{
  display: inline-block;
  text-align: center;
  padding-top: 15px;
  width: 80px;
 }
 .intro .over {
    width: 80px;
    height: 75px;
    border-radius: 7px;
    background: #999;
 }
 .intro li img{
  width: 80px;
  height: 30px;
  padding: 0 25px;
 }
 .intro li:hover{
    padding-top: 10px;
 }
 .intro li .writting{
    margin:7px 0;
 }
 #myTab li:hover .writting{
   color:#66D9EF;
 }
 .following{
  width:100%;
  display: flex;
  flex-wrap: wrap;
  justify-content:flex-start;
  border: 1px solid #EAEAEA;
 }
 .following li{
    flex-basis: 24%;
    margin:20px 0px;
 }
 .following li .thumb{
    width:80px;
    height:80px;
    border-radius: 50%;
 }
 .tab-content{
  margin-top:30px;
 }
 #messages .messageList{
    border-top:1px solid #EAEAEA;
 }
 .message_show{
   margin-top:20px;
 }
 .message_content{
   margin-top: 10px;
   width:80%;
   min-height: 70px;
   height: auto;
   margin: 10px auto;
   border: 1px solid rgb(243, 225, 143);
   border-radius: 10px;
   text-indent: 10px;
 }
 .pager li .active{
   background: #ddd !important;
 }
</style>
</head>
<body class="user-select">
<header class="header">
  <nav class="navbar navbar-default" id="navbar">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-navbar" aria-expanded="false"> <span class="sr-only"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
        <h1 class="logo hvr-bounce-in"><a href="{:url('index/index')}" title=""><img src="__STATIC__/public/bs/images/logo.png" alt=""></a></h1>
      </div>
      <div class="collapse navbar-collapse" id="header-navbar">
        <ul class="nav navbar-nav navbar-right">
           {if condition="$Request.session.banner_id==0"}
              <li class="hidden-index active"><a data-cont="平台首页" href="{:url('index/index')}">平台首页</a></li>
             {else\}
              <li class="hidden-index"><a data-cont="平台首页" href="{:url('index/index')}">平台首页</a></li>
           {/if}
          {volist name="bannerArr" id="value"}
            {if condition="$Request.session.banner_id==$value.id"}
              <li class="active"><a href="{:url('index/indexClass')}?bannerId={$value.id}">{$value['name']}</a></li>
             {else/}
              <li><a href="{:url('index/indexClass')}?bannerId={$value.id}">{$value['name']}</a></li>
            {/if}
          {/volist}
        </ul>
        <form class="navbar-form visible-xs" action="{:url('articleSelect')}" method="post">
          <div class="input-group">
            <input type="text" name="keyword" class="form-control" placeholder="请输入关键字" maxlength="20" autocomplete="off">
            <span class="input-group-btn">
            <button class="btn btn-default btn-search" name="search" type="submit">搜索</button>
            </span> </div>
        </form>
      </div>
    </div>
  </nav>
</header>
<body>
<section class="container">
  <div class="content-wrap">
    <div class="content">
    <article class='article'>
    <section class="container-fluid">
        <div class="row">
          <div class="col-sm-12 col-md-12 col-lg-12 main" id="main">
            <div class="row">
              <form action="{:url('update')}" method='post' enctype='multipart/form-data' class="add-article-form">
                <div class="col-md-12 text-center">
                  <h1 class="page-header text-center">个人中心</h1>
                 <div class="headimg">
                       <a title=""><img class="thumb" style="width: 75px;height: 75px;border-radius: 50%" alt="" src="__STATIC__/{$userInfo['img']}" id="user-photo"></a>
                       <p style="margin-top:20px"></p>
                        <!-- <label for="">更改头像:</label>       -->
                        <!-- <button type="button" class="btn btn-primary"  data-target="#changeModal" data-toggle="modal">头像修改</button> -->
                        <!-- <input type="file" name="img" id="" style='margin:8px 40%;'> -->
                 </div>
                 <div class="modal fade" id="changeModal" tabindex="-1" role="dialog" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                              <h4 class="modal-title text-primary">
                              <i class="fa fa-pencil"></i>
                                          更换头像
                              </h4>
                          </div>
                          <div class="modal-body">
                              <p class="tip-info text-center">
                                  未选择图片
                              </p>
                              <div class="img-container hidden">
                                  <img src="" alt="" id="photo">
                              </div>
                              <div class="img-preview-box hidden">
                                  <hr>
                                  <span>150*150:</span>
                                  <div class="img-preview img-preview-lg">
                                  </div>
                                  <span>100*100:</span>
                                  <div class="img-preview img-preview-md">
                                  </div>
                                  <span>30*30:</span>
                                  <div class="img-preview img-preview-sm">
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <label class="btn btn-danger pull-left" for="photoInput">
                              <input type="file" name="img" class="sr-only" id="photoInput" accept="image/*">
                              <span>打开图片</span>
                              </label>
                              <button type="button" class="btn btn-primary disabled" disabled="true" onclick="sendPhoto();">提交</button>
                              <button type="button" class="btn btn-close" aria-hidden="true" data-dismiss="modal">取消</button>
                          </div>
                      </div>
                  </div>
              </div>
                 <!-- 头像模态框 -->
                 <div class="motai text-center" id="mo">
                   <span class="close" id="close">×</span>
                   <img class="motaiimg" id="moimg">
                   <div id="caption"></div>
                   <button type="button" class="btn btn-primary"  data-target="#changeModal" data-toggle="modal">头像修改</button>
                 </div>
                  <div class="form-group" style='width: 30%;margin:10px auto 0' >
                    <label for="">用户名:</label>
                    <input type="text" class="form-control" name='username' required autocomplete="off" value="{$userInfo['username']}">
                  </div>
                  <div class="form-group" style='width: 30%;margin:0 auto'>
                    <label for="">密码:</label>
                    <input type="password" class="form-control" name='password' required autocomplete="off" value="######">
                  </div>
                  <div class="form-group" style='margin-top:20px;'>
                    <input type="submit" class='btn btn-primary' value="提交">
                    <input type="reset" class='btn btn-danger'>
                  </div>
                </div>
              </form>
              <ul class = "intro" id="myTab">
                <li class="active"><a href="#articlePub" role="tab" data-toggle="tab"><img src="../../static/public/bs/images/icon/blog.png"/><div class="writting">发布的文章</div></a></li>
                <li><a href="#getLove" role="tab" data-toggle="tab"><img src="../../static/public/bs/images/icon/love.png"/><div class="writting">我的关注</div></a></li>
                <li><a href="#collections" role="tab" data-toggle="tab"><img src="../../static/public/bs/images/icon/collection.png"/><div class="writting">我的收藏</div></a></li>
                <li><a href="#messages" role="tab" data-toggle="tab"><img src="../../static/public/bs/images/icon/message.png"/><div class="writting">我的私信</div></a></li>
              </ul>
              <!-- 选项卡 -->
              <div id="myTabContent" class="tab-content">
                 <div class="tab-pane fade in active" id="articlePub">
                    {volist name="myArticleInfoArr" id="value"}
                      <article class="excerpt excerpt-1"><a class="focus" ><img class="thumb" src="__STATIC__/{$value['img']}" alt="">{$value['username']}</a>
                        <header>
                           <a class='cat' href="{:url('/index/index/indexClass')}?bannerId={$value.banner_id}">{$value.name}<i></i></a>
                           <h2><a href="{:url('/index/index/indexReadMore')}?articleId={$value.id}" title=''>{$value.title}</a></h2>
                        </header>
                        <span class="get_article_id" hidden>{$value.id}</span>
                        <p class="meta">
                          <time class="time"><i class="glyphicon glyphicon-time"></i>{$value['time']|date="Y-m-d H:i:s",###}</time></br></br>
                          <span class="views"><i class="glyphicon glyphicon-eye-open"></i> 共<span class="articleView">{$value.views}</span>人围观</span><span class="comment" data-toggle='modal'><i class="glyphicon glyphicon-comment"></i> 共<span class="commentTimes">{$value.comment_times}</span>条评论</span>
                          <span class="goods">
                            {if condition="$value.has_goods == 1"}
                                <i class="good"><a class="show_good_times">{$value.good_times}</a></i>
                                {else}
                                <i class="notgood"><a class="show_good_times">{$value.good_times}</a></i>
                            {/if}
                          </span>
                          </p></br>
                          <a class="cat" href="javascript:">正文<i></i></a>
                          <a class="img-responsive">{$value.content|htmlspecialchars_decode|mb_substr=0,3000,'utf-8'}</a>
                          <p class="note">
                            <a style='float:right;margin-right:70px' href="{:url('/index/index/indexReadMore',['articleId'=>$value.id])}">查看更多>></a></p>

                      </article>
                    {/volist}
                 </div>
                 <div class="tab-pane fade text-center" id="getLove">
                    <ul class="following">
                      {volist name="$followingInfoArr" id="value"}
                          <li><a class="focus" href="{:url('otherInfo')}?otherUserid={$value.id}"><img class="thumb" src="__STATIC__/{$value['img']}" alt=""><p>{$value['username']}</p></a></li>
                      {/volist}
                    </ul>
                 </div>
                 <div class="tab-pane fade" id="collections">
                    {volist name="collectionInfoArr" id="value"}
                      <article class="excerpt excerpt-1"><a class="focus" href="{:url('otherInfo')}?otherUserid={$value.user_id}"><img class="thumb" src="__STATIC__/{$value['img']}" alt="">{$value['username']}</a>
                        <header>
                          <a class='cat' href="{:url('/index/index/indexClass')}?bannerId={$value.banner_id}">{$value.name}<i></i></a>
                          <h2><a href="{:url('/index/index/indexReadMore')}?articleId={$value.id}" title=''>{$value.title}</a></h2>
                        </header>
                        <span class="get_article_id" hidden>{$value.id}</span>
                        <p class="meta">
                          <time class="time"><i class="glyphicon glyphicon-time"></i>{$value['time']|date="Y-m-d H:i:s",###}</time></br></br>
                          <span class="views"><i class="glyphicon glyphicon-eye-open"></i> 共<span class="articleView">{$value.views}</span>人围观</span><span class="comment" data-toggle='modal'><i class="glyphicon glyphicon-comment"></i> 共<span class="commentTimes">{$value.comment_times}</span>条评论</span>
                          <span class="goods">
                            {if condition="$value.has_goods == 1"}
                                <i class="good"><a class="show_good_times">{$value.good_times}</a></i>
                                {else}
                                <i class="notgood"><a class="show_good_times">{$value.good_times}</a></i>
                            {/if}
                          </span>
                          </p></br>
                          <a class="cat" href="javascript:">正文<i></i></a>
                          <a class="img-responsive">{$value.content|htmlspecialchars_decode|mb_substr=0,3000,'utf-8'}</a>
                          <p class="note">
                            <a style='float:right;margin-right:70px' href="{:url('/index/index/indexReadMore',['articleId'=>$value.id])}">查看更多>></a></p>

                      </article>
                  {/volist}
                 </div>
                 <div class="tab-pane fade" id="messages">
                    <div class="messageList">
                        <ul class="pager">
                          <li><a class="active" href="#hasReadMessage" data-toggle="tab">未读</a></li>
                          <li><a href="#notReadMessage" data-toggle="tab">已读</a></li>
                        </ul>
                    </div>
                    <div id="myMessageTab" class="tab-content">
                        <div class="tab-pane fade in active" id="hasReadMessage">
                            {volist name="messageList" id="value"}
                              {if condition="$value.is_read == 0"}
                                <article class="excerpt excerpt-1"><a class="focus" href="{:url('UserInfo/otherInfo')}?otherUserid={$value.send_userid}" ><img class="thumb" src="__STATIC__/{$value['img']}" alt="">{$value['username']}</a>
                                  <p class="meta message_show">
                                    <time class="time"><i class="glyphicon glyphicon-time"></i>{$value['message_sendtime']|date="Y-m-d H:i:s",###}</time>
                                    </p>
                                    <a class="cat" href="javascript:">Message:<i></i></a>
                                    <p class="img-responsive message_content">{$value.message_content}</p>
                                    <p class="note">
                                      <a type="button" class="btn btn-success" style='float:right;margin-right:10%' href="otherinfo?otherUserid={$value.send_userid}">回复</a>
                                      <a type="button" class="btn btn-warning" data="{$value.id}" style='float:right;margin-right:10%'>标记为已读</a>
                                </article>
                              {/if}
                            {/volist}
                         </div>
                        <div class="tab-pane fade" id="notReadMessage">
                            {volist name="messageList" id="value"}
                              {if condition="$value.is_read == 1"}
                                <article class="excerpt excerpt-1"><a class="focus" href="{:url('UserInfo/otherInfo')}?otherUserid={$value.send_userid}"><img class="thumb" src="__STATIC__/{$value['img']}" alt="">{$value['username']}</a>
                                  <p class="meta message_show">
                                    <time class="time"><i class="glyphicon glyphicon-time"></i>{$value['message_sendtime']|date="Y-m-d H:i:s",###}</time>
                                    </p>
                                    <a class="cat" href="javascript:">Message:<i></i></a>
                                    <p class="img-responsive message_content">{$value.message_content}</p>
                                    <p class="note">
                                      <input type="button" class="btn btn-success" style='float:right;margin-right:70px' href="{:url('/index/index/indexReadMore',['articleId'=>$value.id])}" value="回复"></p>
                                </article>
                              {/if}
                            {/volist}
                        </div>
                    </div>
                 </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </article>
  </div>
  </div>
  <aside class="sidebar">
    <div class="fixed">
      <div class="widget widget-tabs">
        <ul class="nav nav-tabs" role="tablist">
          <li role="presentation" class="active"><a href="#notice" aria-controls="notice" role="tab" data-toggle="tab">网站公告</a></li>
          <li role="presentation"><a href="#centre" aria-controls="centre" role="tab" data-toggle="tab">会员中心</a></li>
          <li role="presentation"><a href="#contact" aria-controls="contact" role="tab" data-toggle="tab">联系站长</a></li>
        </ul>
        <div class="tab-content">
          <div role="tabpanel" class="tab-pane notice active" id="notice">
            <ul>
                {volist name="noticeArr" id="value"}
                    <li>
                      <time>{$value['time']|date="m-d",###}</time>
                      <a data-toggle='modal' data-target='#noticeModal'>{$value['content']}</a>
                    </li>
                {/volist}
            </ul>
          </div>
          <div role="tabpanel" class="tab-pane centre" id="centre">
            <h4>需要登录才能进入会员中心</h4>
            <p> <a data-toggle="modal" data-target="#loginModal" class="btn btn-primary">立即登录</a> <a href="javascript:;" class="btn btn-default">现在注册</a> </p>
          </div>
          <div role="tabpanel" class="tab-pane contact" id="contact">
            <h2>Email:<br />
              <a href="mailto:4041812@qq.com" data-toggle="tooltip" data-placement="bottom" title="4041812@qq.com">4041812@qq.com</a></h2>
          </div>
        </div>
      </div>
      <div class="widget widget_search">
        <form class="navbar-form" action="{:url('articleSelect')}" method="post">
          <div class="input-group">
            <input type="text" name="keyword" class="form-control" size="35" placeholder="请输入关键字" maxlength="15" autocomplete="off">
            <span class="input-group-btn">
            <button class="btn btn-default btn-search" name="search" type="submit">搜索</button>
            </span> </div>
        </form>
      </div>
      <div class="widget widget_sentence">
        <h3>每日一句</h3>
        <div class="widget-sentence-content">
          <h4>{$daily_talkArr['time']|date="Y年m月d日",###} 星期<?php echo mb_substr( "日一二三四五六",date("w"),1,"utf-8" ); ?></h4>
          <p style="line-height: 22px">{$daily_talkArr['content']}</p>
        </div>
      </div>
    </div>
    <div class="widget widget_hot">
      <h3>热门文章</h3>
      <ul>
          {volist name="hotArticleArr" id="value"}
             <li><a href="{:url('index/indexReadMore')}?articleId={$value.id}"><span class="thumbnail"><img class="thumb"  alt="" src="__STATIC__/{$value['img']}"></span><span class="text">{$value.title}</span><span class="muted" style="display: block;line-height: 30px"><i class="glyphicon glyphicon-time"></i>{$value['time']|date="Y-m-d H:i:s",###}</span><span class="muted"><i class="glyphicon glyphicon-eye-open"></i>{$value.views}</span><span class="muted"><i class="glyphicon glyphicon-comment"></i>{$value.comment_times}</span>
              <span class="muted" style="margin-left:25px">
              {if condition="$value.has_goods == 1"}
                <i class="glyphicon-good"></i>
                {else}
                <i class="glyphicon-notgood"></i>
              {/if}
              {$value.good_times}</span>
             </a></li>
          {/volist}
      </ul>
    </div>
  </aside>
</section>
<footer class="footer">
  <div class="container">
    <p>&copy; 2016 <a href="">ylsat.com</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" target="_blank" rel="nofollow">豫ICP备20151109-1</a> &nbsp; <a href="sitemap.xml" target="_blank" class="sitemap">网站地图</a></p>
  </div>
  <div id="gotop"><a class="gotop"></a></div>
</footer>

<!-- 公告模态 -->
<div id="noticeModal" class='modal fade'>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <div class="close" data-dismiss='modal'>&times;</div>
        <h3>网站公告</h3>
      </div>
      <div class="modal-body">
        <div class="tab-content">
        <div role="tabpanel" class="tab-pane notice active" id="notice">
        <ul>
          {volist name="noticeArr" id="value"}
            <li style='color:#999999;list-style: binary;margin-left:10px'>
              <p style='color:#999999;width:520px;'> {$value['content']}</p>
              <p style='text-align:right'>{$value['time']|date="m-d",###}</p>
            </li>
          {/volist}
        </ul>
      </div>
      </div>
      <div class="modal-footer">
        <button class='btn btn-primary' data-dismiss='modal'>我知道了</button>          </div>
    </div>
  </div>
</div>
<script src="https://cdn.bootcss.com/cropper/3.1.3/cropper.min.js"></script>
<script src="__STATIC__/public/bs/js/bootstrap.min.js"></script>
<script src="__STATIC__/public/bs/js/jquery.ias.js"></script>
<script src="__STATIC__/public/bs/js/scripts.js"></script>
    <script>
     var initCropperInModal = function(img, input, modal){
            var $image = img;
            var $inputImage = input;
            var $modal = modal;
            var options = {
                aspectRatio: 1, // 纵横比
                viewMode: 2,
                preview: '.img-preview' // 预览图的class名
            };
            // 模态框隐藏后需要保存的数据对象
            var saveData = {};
            var URL = window.URL || window.webkitURL;
            var blobURL;
            $modal.on('show.bs.modal',function () {
                // 如果打开模态框时没有选择文件就点击“打开图片”按钮
                if(!$inputImage.val()){
                    $inputImage.click();
                }
            }).on('shown.bs.modal', function () {
                // 重新创建
                $image.cropper( $.extend(options, {
                    ready: function () {
                        // 当剪切界面就绪后，恢复数据
                        if(saveData.canvasData){
                            $image.cropper('setCanvasData', saveData.canvasData);
                            $image.cropper('setCropBoxData', saveData.cropBoxData);
                        }
                    }
                }));
            }).on('hidden.bs.modal', function () {
                // 保存相关数据
                saveData.cropBoxData = $image.cropper('getCropBoxData');
                saveData.canvasData = $image.cropper('getCanvasData');
                // 销毁并将图片保存在img标签
                $image.cropper('destroy').attr('src',blobURL);
            });
            if (URL) {
                $inputImage.change(function() {
                    var files = this.files;
                    var file;
                    if (!$image.data('cropper')) {
                        return;
                    }
                    if (files && files.length) {
                        file = files[0];
                        if (/^image\/\w+$/.test(file.type)) {

                            if(blobURL) {
                                URL.revokeObjectURL(blobURL);
                            }
                            blobURL = URL.createObjectURL(file);

                            // 重置cropper，将图像替换
                            $image.cropper('reset').cropper('replace', blobURL);

                            // 选择文件后，显示和隐藏相关内容
                            $('.img-container').removeClass('hidden');
                            $('.img-preview-box').removeClass('hidden');
                            $('#changeModal .disabled').removeAttr('disabled').removeClass('disabled');
                            $('#changeModal .tip-info').addClass('hidden');

                        } else {
                            window.alert('请选择一个图像文件！');
                        }
                    }
                });
            } else {
                $inputImage.prop('disabled', true).addClass('disabled');
            }
        }


    var sendPhoto = function(){
        $('#photo').cropper('getCroppedCanvas',{
            width:300,
            height:300
        }).toBlob(function(blob){
            // 转化为blob后更改src属性，隐藏模态框
            $('#user-photo').attr('src',URL.createObjectURL(blob));
            $('#changeModal').modal('hide');
        });
    }

    $(function(){
        initCropperInModal($('#photo'),$('#photoInput'),$('#changeModal'));
        // 选项卡
      $('#myTab li a').click(function(){
        var a = $(this).find('a').attr('href');
        $(a).show().siblings().hide();
      })
    });

     var motai=document.getElementById('mo')
     var moimg=document.getElementById("moimg")
     var realimg=document.getElementById("user-photo")
     var caption=document.getElementById("caption")
     realimg.onclick=function(){
      motai.style.display="block"
      moimg.src=this.src
      caption.innerHTML=this.alt
     }
     var span=document.getElementById("close");
     span.onclick=function(){
      $('#motai').hide(1000);
     }
     motai.onclick=function(){
      $('#mo').hide();
     }

     // li浮动效果
     var oLi = $('.intro li');
     var activeIndex = 0;
     oLi.eq(0).addClass('over');
     oLi.mouseover(function() {
       var _this = $(this);
       $(this).addClass('over').siblings().not(oLi.eq(activeIndex)).removeClass('over');
       oLi.mouseout(function(){
        oLi.eq(activeIndex).siblings().removeClass('over');
       })
     })
     oLi.click(function() {
      activeIndex = $(this).index();
       $(this).addClass('over').siblings().removeClass('over');
     })
    //已读和未读
    $('.pager li').click(function(){
        $(this).find('a').addClass('active');
        $(this).siblings().find('a').removeClass('active');
    })
    // 标记为已读
    $('#hasReadMessage .btn-warning').click(function(){
      var messageIndex = $(this).index('.btn-warning');
      var messageId = $(this).attr('data');
      var _this = $(this);
      $.ajax({
        url: 'setHasRead',
            type:'POST',
            data:{
              'messageId': messageId
            },
            success:function(res){
              if(res == '0'){
                _this.hide();
                $('#hasReadMessage article').eq(messageIndex).hide();
                var hasReadMessageHtml ="<article class='excerpt excerpt-1'>"+$('#hasReadMessage article').eq(messageIndex).html()+"</article>";
                $('#notReadMessage').html(hasReadMessageHtml+$('#notReadMessage').html());
              }else{
                console.log('标记已读失败！')
              }
            }
      })
    })
     // 点赞
    $('.goods').click(function(){
        var goodsIndex = $(this).index('.meta .goods');
        var goodsClassName = $('.meta .goods').eq(goodsIndex).children()[0].className;
        var good_times = $('.meta .goods').eq(goodsIndex).find('.show_good_times').html();
        if(goodsClassName == 'good'){
          good_times = parseInt(good_times)-1;
          good_times = good_times < 0 ? 0 :good_times;
        }else{
          good_times = parseInt(good_times)+1;
        }
        var article_id = $('.get_article_id').eq(goodsIndex).html();
        $.ajax({
            url: '../Article/addGoods',
            type:'POST',
            data:{
              'good_times': good_times,
              'article_id': article_id
            },
            success:function(res){
              if(res == 0){
                  if(goodsClassName == 'good'){
                    $('.goods').eq(goodsIndex).html("<i class='notgood'><a class='show_good_times'>"+ good_times +"</a></i>");
                  }else{
                    $('.goods').eq(goodsIndex).html("<i class='good'><a class='show_good_times'>"+ good_times +"</a></i>");
                  }
              }else{
                console.log('点赞失败！')
              }
            }
        })
    })
    </script>
</body>
</html>